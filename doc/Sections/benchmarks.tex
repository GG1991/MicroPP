
\section{Benchmarks}


\subsection{\texttt{benchmarks-sol-ass}}

This benchmark is intended to measure the computing times of the assembly of the Residue vector ($\times2$) and the
Jacobian matrix and the solver (CGPD).

Basically the benchmark executes a tipical Newton-Raphson iteration:

\begin{lstlisting}[language=c++, backgroundcolor=\color{lightgray} ]
	double norm = assembly_rhs_acc(u, nullptr, b);

#ifdef _OPENACC
	assembly_mat_acc(&A, u, nullptr);
#else
	assembly_mat(&A, u, nullptr);
#endif

#ifdef _OPENACC
	int cg_its = ell_solve_cgpd_acc(&A, b, du, &cg_err);
#else
	int cg_its = ell_solve_cgpd(&A, b, du, &cg_err);
#endif

	for (int i = 0; i < nn * dim; ++i)
		u[i] += du[i];

	norm = assembly_rhs_acc(u, nullptr, b);
\end{lstlisting}

To execute this benchmark:

\begin{lstlisting}[language=Bash,backgroundcolor=\color{lightgray} ]
./benchmark-sol-ass
\end{lstlisting}

\begin{figure}[!htbp]
	\centering
	\begin{tikzpicture}[]
		\pgfplotsset{every tick label/.append style={font=\small}}
		\pgfplotstableread{data/benchmark-sol-ass-macintosh-intel-I7-3520M.dat}{\times}
		\begin{axis}[
			grid=major,
			y unit=s,
			legend pos=north west,
			legend cell align={left},
			ylabel=Computing Time,
			xlabel=Micro-Scale Mesh Resolution,
			x unit=\# Elements,
			scaled y ticks=false,
			xmin=-1,
			ymin=-1,
			xtick = {0,20,40,60,80,100},
			xticklabels = {0,20\tst,40\tst,60\tst,80\tst,100\tst},
			]
			\addplot [color=blue,mark=*,line width = 0.5mm] table [x index={0}, y
				expr=\thisrowno{1}*1.0e-3] {\times};
			\addplot [color=green,mark=*,line width = 0.5mm] table [x index={0}, y
				expr=\thisrowno{2}*1.0e-3] {\times};
			\legend{Jacobian \& Residue Assembly, Solver}
		\end{axis}
	\end{tikzpicture}
	\caption{\label{fig:ass_vs_sol}
		Computing time used for the assembly of the Jacobian Matrix and the Residue vector and
		the solver algorithm of the Micropp code to perform the micro-scale FE
		calculation in an Intel Core i7-3520M CPU 2.90GHz.
	}
\end{figure}

\subsection{\texttt{benchmarks-cpu-gpu}}
\subsection{\texttt{benchmarks-elastic}}
\subsection{\texttt{benchmarks-plastic}}
\subsection{\texttt{benchmarks-damage}}
\subsection{\texttt{benchmarks-mic-1}}
\subsection{\texttt{benchmarks-mic-2}}
\subsection{\texttt{benchmarks-mic-3}}
